import matplotlib.pyplot as plt

mnist_gce_005_test = [0.9461, 0.9673, 0.9803, 0.9825, 0.9798, 0.9838, 0.9848, 0.9854, 0.9857, 0.9868, 0.986, 0.9881, 0.9857, 0.9844, 0.9855, 0.9859, 0.9849, 0.9857, 0.9847, 0.9848, 0.9847, 0.984, 0.9837, 0.9849, 0.9836, 0.9839, 0.9851, 0.9835, 0.9851, 0.9835, 0.9834, 0.9829, 0.9825, 0.9818, 0.9817, 0.9837, 0.9831, 0.9828, 0.9812, 0.8914, 0.8914, 0.8914, 0.8914, 0.8914, 0.8914, 0.8914, 0.8914, 0.8914, 0.8914, 0.8914, 0.8914, 0.8914, 0.8914, 0.8914, 0.8914, 0.8914, 0.8914, 0.8914, 0.8914, 0.8914]
mnist_gce_03_test = [0.921, 0.9654, 0.9744, 0.9799, 0.9765, 0.9812, 0.9847, 0.9852, 0.9844, 0.987, 0.9857, 0.9885, 0.9859, 0.9857, 0.9858, 0.9867, 0.9873, 0.9868, 0.9846, 0.9879, 0.9857, 0.986, 0.9853, 0.9872, 0.9862, 0.9866, 0.986, 0.9856, 0.9868, 0.9874, 0.9866, 0.9853, 0.9855, 0.9862, 0.9867, 0.9866, 0.9848, 0.9859, 0.985, 0.985, 0.985, 0.985, 0.985, 0.985, 0.985, 0.985, 0.985, 0.985, 0.985, 0.985, 0.985, 0.985, 0.985, 0.985, 0.985, 0.985, 0.985, 0.985, 0.985, 0.985]
mnist_ce_005_test = [0.9463, 0.974, 0.9812, 0.9834, 0.9804, 0.9837, 0.985, 0.9866, 0.9852, 0.9874, 0.9867, 0.9889, 0.9859, 0.9848, 0.9866, 0.9844, 0.9864, 0.9853, 0.9831, 0.9855, 0.9809, 0.9827, 0.984, 0.9852, 0.9829, 0.9803, 0.98, 0.981, 0.9839, 0.9831, 0.9828, 0.981, 0.9838, 0.9802, 0.9828, 0.9835, 0.9815, 0.9822, 0.9776, 0.9824, 0.9822, 0.9795, 0.98, 0.9802, 0.9803, 0.9823, 0.9787, 0.9816, 0.9821, 0.9814, 0.9824, 0.9817, 0.981, 0.9783, 0.9801, 0.9799, 0.9788, 0.9796, 0.9804, 0.9821]
mnist_gce_adam_005_test = [0.9243, 0.6439, 0.181, 0.0893, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974, 0.0974]
cifar10_gce_005_test = [0.4391, 0.5688, 0.6268, 0.6893, 0.7148, 0.7227, 0.7599, 0.7835, 0.758, 0.787, 0.8098, 0.8138, 0.8184, 0.8152, 0.8206, 0.8073, 0.8389, 0.837, 0.856, 0.8264, 0.8496, 0.8486, 0.8269, 0.8595, 0.8565, 0.8524, 0.8546, 0.8537, 0.8622, 0.8592, 0.8905, 0.8921, 0.8933, 0.892, 0.891, 0.8911, 0.8905, 0.8918, 0.8902, 0.8898, 0.8906, 0.8907, 0.8911, 0.8902, 0.8902, 0.8912, 0.8902, 0.891, 0.8894, 0.891, 0.8909, 0.8905, 0.8893, 0.8905, 0.889, 0.8909, 0.8901, 0.8908, 0.8916, 0.8911, 0.8908, 0.8893, 0.8899, 0.889, 0.8902, 0.8906, 0.8912, 0.8901, 0.8905, 0.8899, 0.8903, 0.8899, 0.8907, 0.8902, 0.8901, 0.8896, 0.8904, 0.8906, 0.8887, 0.8896]
cifar10_gce_03_test = [0.4253, 0.5326, 0.6282, 0.6815, 0.7059, 0.7184, 0.7445, 0.7702, 0.7856, 0.7688, 0.7949, 0.7994, 0.8089, 0.8124, 0.8074, 0.7634, 0.8337, 0.8292, 0.841, 0.8268, 0.8362, 0.8365, 0.8393, 0.8424, 0.8542, 0.8518, 0.8565, 0.8471, 0.8614, 0.8448, 0.8874, 0.8895, 0.8875, 0.8886, 0.8895, 0.8884, 0.8915, 0.8903, 0.8941, 0.8934, 0.893, 0.8939, 0.8938, 0.8935, 0.8944, 0.8936, 0.8944, 0.8937, 0.8924, 0.8945, 0.8931, 0.8945, 0.8936, 0.8931, 0.894, 0.8928, 0.8927, 0.8943, 0.8931, 0.8937, 0.8939, 0.8935, 0.8936, 0.8932, 0.8932, 0.8938, 0.893, 0.8939, 0.8933, 0.8928, 0.8941, 0.8939, 0.8934, 0.8946, 0.8946, 0.8945, 0.8927, 0.8927, 0.8943, 0.8932]
cifar10_ce_005_test = [0.4874, 0.5908, 0.6471, 0.7133, 0.7322, 0.7295, 0.7861, 0.7922, 0.784, 0.8013, 0.7966, 0.8335, 0.8125, 0.8272, 0.8425, 0.8291, 0.8512, 0.8359, 0.8473, 0.8346, 0.8362, 0.8528, 0.8511, 0.8693, 0.8363, 0.8561, 0.8508, 0.8578, 0.8658, 0.8624, 0.8921, 0.8939, 0.8925, 0.8927, 0.894, 0.8933, 0.8909, 0.8901, 0.894, 0.8892, 0.8929, 0.8887, 0.8906, 0.8908, 0.8926, 0.8898, 0.8893, 0.8897, 0.8873, 0.8887, 0.8894, 0.8879, 0.8871, 0.884, 0.8828, 0.885, 0.8842, 0.8837, 0.883, 0.8866, 0.8855, 0.8858, 0.8859, 0.8853, 0.885, 0.8849, 0.8852, 0.8838, 0.8851, 0.8839, 0.8838, 0.8865, 0.884, 0.8845, 0.8851, 0.8841, 0.8829, 0.8837, 0.8815, 0.8819]
cifar10_gce_adam_005_test = [0.3689, 0.4199, 0.5277, 0.572, 0.6061, 0.5875, 0.6821, 0.7086, 0.7188, 0.7443, 0.7389, 0.752, 0.7863, 0.7877, 0.8071, 0.8014, 0.8009, 0.8215, 0.8278, 0.819, 0.8382, 0.8275, 0.8354, 0.842, 0.8354, 0.8335, 0.8399, 0.8323, 0.8517, 0.8456, 0.8704, 0.8768, 0.8771, 0.8786, 0.8747, 0.8767, 0.8767, 0.8761, 0.876, 0.8764, 0.8766, 0.8771, 0.8772, 0.8762, 0.8765, 0.8768, 0.8757, 0.8772, 0.8761, 0.8769, 0.8767, 0.8769, 0.8772, 0.8774, 0.8765, 0.8762, 0.8775, 0.8777, 0.8765, 0.876, 0.8765, 0.8767, 0.8762, 0.8766, 0.8771, 0.8768, 0.8771, 0.8767, 0.8779, 0.8767, 0.876, 0.8766, 0.8766, 0.8771, 0.877, 0.8766, 0.876, 0.8763, 0.8776, 0.8781]
fashion_gce_005_test = [0.8886, 0.9626, 0.9762, 0.9782, 0.9781, 0.9837, 0.9854, 0.9858, 0.9851, 0.9867, 0.9879, 0.9883, 0.9865, 0.9891, 0.9879, 0.9873, 0.9861, 0.9879, 0.9843, 0.9873, 0.9868, 0.9882, 0.9848, 0.9877, 0.9861, 0.9868, 0.9865, 0.9853, 0.9873, 0.9861, 0.9862, 0.9876, 0.9867, 0.9861, 0.9871, 0.9876, 0.9878, 0.9853, 0.9871, 0.9871, 0.9871, 0.9871, 0.9871, 0.9871, 0.9871, 0.9871, 0.9871, 0.9871, 0.9871, 0.9871, 0.9871, 0.9871, 0.9871, 0.9871, 0.9871, 0.9871, 0.9871, 0.9871, 0.9871, 0.9871]
fashion_gce_adam_005_test = [0.9585, 0.7362, 0.5806, 0.4382, 0.3711, 0.1139, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057, 0.2057]

mnist_gce_005_train = [-1.3915957052442762, -1.8387349503128616, -1.8654295716462312, -1.8794555706448026, -1.887533949110243, -1.8923560525399667, -1.8960579116256149, -1.899861129478172, -1.9017089863529912, -1.9038729375203451, -1.9050983974315503, -1.906994378266511, -1.9085839224921333, -1.9103437553688332, -1.9106343183164243, -1.9127575485794632, -1.9142733660097475, -1.9143495415581597, -1.9170113118489582, -1.9165403643007632, -1.91821216668023, -1.9191081396032263, -1.9200161607530382, -1.9216707938865378, -1.9225181415699146, -1.9219420256438078, -1.9240540802567094, -1.924099748964663, -1.9250256946705007, -1.9264318895693178, -1.9271054630985966, -1.9262888324878833, -1.9286053410282842, -1.9292851455123337, -1.9296791263156468, -1.9299561047024196, -1.930725560788755, -1.9313876727068866, -1.9297823675650136, -1.803941771895797, -1.823061087431731, -1.823735029997649, -1.8239694129096138, -1.8241404642175745, -1.8240707089459454, -1.824286501566569, -1.8242889729252567, -1.824203527097349, -1.8243911158243815, -1.8242672023066768, -1.8242267116970485, -1.824323016413936, -1.824325793230975, -1.8243285013834636, -1.824303187334979, -1.8244438210946543, -1.8242705049867982, -1.8246075673986364, -1.8248159939801252, -1.825053035594799]
mnist_gce_03_train = [0.16532962685437114, -0.35222395111013344, -0.39300476966080844, -0.40810873049276847, -0.4159335667292277, -0.42057072704809684, -0.4235950336456299, -0.4272249811666983, -0.42876892739755135, -0.4307748826698021, -0.43276879229368986, -0.43419183363737884, -0.4352976679272122, -0.4363327976156164, -0.43721711448386863, -0.4382809599064015, -0.4401159058853432, -0.44060876178741454, -0.4409078186176441, -0.4418661331600613, -0.4425735456855209, -0.44284166639822503, -0.4433378512417829, -0.44398979204672356, -0.44448086473676895, -0.4450614324852272, -0.4459405774716978, -0.4453271326488919, -0.44650546872174296, -0.44675821655767933, -0.4480537263022529, -0.44787808248731825, -0.4490917984997785, -0.44842722264042606, -0.449075769883615, -0.44976358533788613, -0.45007893474013716, -0.4493321736300433, -0.44981778317910653, -5.0689933209300595e-05, -5.085704098800542e-05, -5.10636399137891e-05, -5.132107111556386e-05, -5.164253295192288e-05, -5.2045028234176614e-05, -5.255066387838236e-05, -5.3188553364533516e-05, -5.399756086990237e-05, -5.503050394839159e-05, -5.636072972858394e-05, -5.8092796735258564e-05, -6.0380708719431254e-05, -6.346069610919113e-05, -6.771407324682783e-05, -7.379839919438516e-05, -8.295182057621855e-05, -9.781129532321184e-05, -0.00012514524958613847, -0.0001890504871736522, -0.0004946852593372265]
mnist_ce_005_train = [1.4557483047202782, 1.0141780183580187, 0.98844569128531, 0.9745276904635959, 0.9671353612829138, 0.9616698130854854, 0.9577462466204608, 0.9536329430474175, 0.9526411312244557, 0.9495965690612793, 0.9491708022223578, 0.946489576127794, 0.9445715507224755, 0.9431169935155798, 0.942972363224736, 0.940894763522678, 0.9392268364517777, 0.9382219174702963, 0.9362767893473307, 0.9353543412950304, 0.9346415201822916, 0.9332262212965223, 0.9325232064988878, 0.9320856795134368, 0.9307711033291287, 0.9294087561148184, 0.9281514324612088, 0.9278181009645815, 0.92641971983733, 0.9261540592334888, 0.9257287972061722, 0.9242583924752694, 0.9231262724134657, 0.9233934775458442, 0.9228812788504142, 0.9216646632441768, 0.9203224816498933, 0.9193060386092574, 0.919785828060574, 0.9197753242210106, 0.9172580750076859, 0.9186447306032534, 0.9176180712381998, 0.9166902727197718, 0.9173432898344817, 0.9172219467163086, 0.9155088792023836, 0.9138914623966924, 0.9141094025505914, 0.9133471110308612, 0.9124171887150517, 0.9126974313524034, 0.9112213403207284, 0.9110522177660907, 0.9117995640790021, 0.9135889714558919, 0.9130319350913719, 0.9121821615431044, 0.9125475804364239, 0.911525611029731]
mnist_gce_adam_005_train = [-1.6824780680338542, -1.4935448421902127, -0.993255251566569, -0.5753526637112653, -0.6007156901889377, -0.6032212053934733, -0.6058958476031268, -0.6069588453504774, -0.6075394360577618, -0.6078994078459563, -0.6081563801235623, -0.6083482668841327, -0.6085392732973453, -0.6086756461814598, -0.6088347423694752, -0.6088715799119737, -0.6090000159652145, -0.6089150393450702, -0.6090314332467538, -0.6090560030054163, -0.6090872825339988, -0.6091685232939543, -0.6092805164478443, -0.6095201904862015, -0.6094909625583225, -0.6096598540412055, -0.6097767447012442, -0.60976941341824, -0.6098064682571976, -0.6097320528383608, -0.6098382405881528, -0.6099271621704102, -0.6098879819799352, -0.6099731934158891, -0.6098667129234031, -0.6100740119086372, -0.6099925213566533, -0.6101002868369774, -0.6101544464959039, -0.6100762658295809, -0.6100764226560239, -0.6101636644999187, -0.6099561267428928, -0.6101420923868816, -0.6099777641296387, -0.6100488507306134, -0.6101004264266403, -0.6100534101415563, -0.6100549062093099, -0.6101970505891023, -0.6103087474681713, -0.6106275922987197, -0.6104867176479764, -0.6107151343734176, -0.6106610905682599, -0.610610147829409, -0.6106509598626031, -0.6103682823181152, -0.6103995454576281, -0.6103197986461498]
cifar10_gce_005_train = [-0.9348715508355034, -1.1298453723483615, -1.2411504353841145, -1.3167518480088976, -1.3752463962131076, -1.4218742451985678, -1.4601045505099826, -1.4909243431939019, -1.5208299377441405, -1.547682477484809, -1.5710692338731553, -1.5890935129801431, -1.6121338104248046, -1.6275303344726562, -1.6398472761366103, -1.6601016116672092, -1.6711062194824218, -1.6829333943684897, -1.6985073364257812, -1.7141575022379558, -1.7214496965196397, -1.732028062947591, -1.7404460106743707, -1.7515878926595052, -1.7617931735568577, -1.7731029476589626, -1.7753280951605903, -1.7856154327392577, -1.7929354793972438, -1.8011149631076389, -1.8491789008246529, -1.8618678700764975, -1.8691203236897787, -1.8745616543240018, -1.8769581261528863, -1.8820671617296008, -1.8849810458713108, -1.8873694580078124, -1.890206490749783, -1.896959358384874, -1.8955629679361978, -1.8962586656358507, -1.8958425611707899, -1.8969346445719402, -1.8958717291937934, -1.8968757975260417, -1.8961811611599393, -1.8969662634955513, -1.8980436686197917, -1.8984517679850261, -1.897536819797092, -1.897386178249783, -1.8975011471218532, -1.8994364946153428, -1.900005913289388, -1.8997196217854817, -1.8995717139350043, -1.897617621866862, -1.8996262305365668, -1.8988935353597005, -1.8989225769042968, -1.9005416541205513, -1.8996375935872396, -1.9002688178168403, -1.9003476508246528, -1.8992297271728515, -1.8991513675265843, -1.9003618916829428, -1.8987336992051866, -1.898990162150065, -1.8998228369818793, -1.8983773491753473, -1.8997320098876953, -1.9005393222384983, -1.8998255228678385, -1.9004096320258246, -1.8991137220594618, -1.9002850002712675, -1.900865271335178, -1.9005891374376085]
cifar10_gce_03_train = [0.434378918033176, 0.2952938362121582, 0.22068148782518174, 0.1708976973639594, 0.12268527228865359, 0.08584770346416368, 0.05553398278090689, 0.029794458050363595, 0.0039931091242366365, -0.020406268510056867, -0.03545992125686672, -0.05689856566670868, -0.07597583826002148, -0.0915131602048046, -0.10728042859584093, -0.12436470319976409, -0.1356285950322946, -0.1496157788147529, -0.16374846881628036, -0.17884035681883495, -0.18467577310933006, -0.1959121072265837, -0.20671356949938668, -0.21906295302708945, -0.22785447215504118, -0.23795292597876655, -0.2413360839366913, -0.25237790220048695, -0.2605975603103638, -0.2709861698044671, -0.3061349715338813, -0.31572291049957274, -0.32177086664835614, -0.32551408049265546, -0.3281957227283054, -0.33100454512702093, -0.33314133584764266, -0.3354647350947062, -0.33751141022576225, -0.00023890956660939586, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804, -0.00023890901539060804]
cifar10_ce_005_train = [1.948795839436849, 1.7386666507297093, 1.6238954698350694, 1.5418358700222439, 1.4767643527560763, 1.4262983862982856, 1.3906423665364582, 1.3623076548258464, 1.3307316324869791, 1.3052876491970486, 1.2798347083197699, 1.2596434058295356, 1.2386927049424914, 1.2231738442314997, 1.2059526123046875, 1.1885425384521484, 1.176667573208279, 1.1615298731486003, 1.149192997572157, 1.1381686770968966, 1.129768864271376, 1.1145575442843967, 1.1084238557603625, 1.0989888393825955, 1.0877755398220486, 1.0793712814331056, 1.0733113008287218, 1.066521139356825, 1.0588350460476346, 1.0469082931518554, 0.9975925496419271, 0.9815242229885525, 0.974188937886556, 0.9677876347859701, 0.9650813212076823, 0.9620630093044705, 0.9589943354288737, 0.9562747582329644, 0.9531839201185438, 0.949998760816786, 0.9481959454006619, 0.9468484244452583, 0.9423912733289931, 0.9387695341322158, 0.9374971149020724, 0.935310359870063, 0.9341493291219075, 0.9296950622558594, 0.9257041851467557, 0.9262534233940972, 0.9244076314290365, 0.921227072652181, 0.921263916015625, 0.9155965067545573, 0.9120805006239149, 0.9119363750881619, 0.9104562250773112, 0.9070196027967665, 0.9051463575575087, 0.9035600877549913, 0.8980724251641168, 0.8969510231865777, 0.8964270597669813, 0.8954968626234266, 0.8943848873562283, 0.8921566224839952, 0.8934346294826931, 0.8927439758300781, 0.8918212524414062, 0.8908507222493489, 0.8919149631076388, 0.8911221186319987, 0.8908141372680664, 0.8917443869696723, 0.8908037946912978, 0.8900219239976671, 0.8889195629543728, 0.8890748848809136, 0.8873689724392361, 0.888192887878418]
cifar10_gce_adam_005_train = [-0.781801195356581, -0.937736976453993, -1.0320445222642687, -1.0917464263916015, -1.1767540120442708, -1.2406982004801432, -1.2860768281724717, -1.3548866614447699, -1.391571634250217, -1.4262558346218532, -1.4587993191189237, -1.4852719160291883, -1.517047928873698, -1.5412064076741536, -1.5651883585611979, -1.5840813120524089, -1.6033696078830295, -1.6202438093397353, -1.6392998864067925, -1.6536792663574218, -1.6626791629367406, -1.6849373847113716, -1.6935828589545356, -1.7058451300726996, -1.717666109890408, -1.7313983188205295, -1.740272735595703, -1.7500859853108723, -1.758787003241645, -1.7733503177218968, -1.8168774366590712, -1.8316399183485244, -1.8416184343126085, -1.8484638834635416, -1.8533619852701824, -1.8565766323513455, -1.858697317843967, -1.8650709245469834, -1.867123819647895, -1.8731030636257595, -1.873591133626302, -1.8746820370144315, -1.8747063147650824, -1.8749995934380426, -1.8749252848307292, -1.8754680979410807, -1.8745146233452692, -1.8737319814046225, -1.8778959303114149, -1.8765820570203993, -1.8774714864095052, -1.8771513407389322, -1.8772025638156467, -1.8786867882622613, -1.877523412068685, -1.8771390458848742, -1.879228556315104, -1.8773918416341147, -1.8813234191894532, -1.8782573964436848, -1.880066805013021, -1.878050713772244, -1.8792289910210505, -1.8779771562364367, -1.879014067247179, -1.8804297132703993, -1.8807541473388671, -1.8802461246066624, -1.8774612240261501, -1.8795959784613716, -1.878232935248481, -1.8796633989122178, -1.8794586608886719, -1.8799632147894965, -1.8796418924967448, -1.8789650977240668, -1.8793885592990451, -1.879332568359375, -1.8805486589219835, -1.8781639129638672]
fashion_gce_005_train = [-0.99561186698631, -1.7980092394793474, -1.8582207898740415, -1.8725783335367838, -1.881784693400065, -1.887546817638256, -1.8917241634792752, -1.8947747884679724, -1.8975090899997287, -1.8990699694598163, -1.9013222365202727, -1.9030601591887297, -1.9052478722466364, -1.9060080038000036, -1.9073776445742006, -1.9088457881786205, -1.9099994905259874, -1.9115356705277053, -1.913097130952058, -1.9131476508246528, -1.9142512283325195, -1.9156522383513275, -1.915673215230306, -1.916882367734556, -1.9180186479356554, -1.9193674692224574, -1.9183717597678855, -1.9199939651489257, -1.920798346342864, -1.922379817256221, -1.9227810358118127, -1.9228613781399198, -1.924283435680248, -1.9248459195737486, -1.9253641597606517, -1.9264343021534107, -1.9266745800442167, -1.927066672148528, -1.9280317300867151, -1.9310835997970015, -1.93111550366437, -1.9311496873078522, -1.9311151456479674, -1.9311212231671369, -1.931023011666757, -1.9311676449245876, -1.9311323959915727, -1.9310598805745443, -1.93117539412887, -1.9310611281218353, -1.9310138346354166, -1.9310952784220377, -1.9311143572771992, -1.9310425149423105, -1.9310454785382307, -1.931128436335811, -1.93095773852313, -1.9311929194132487, -1.9310346498842592, -1.9310425304836698]
fashion_gce_adam_005_train = [-1.7090708913449888, -1.5800351929841219, -1.1061027977554887, -0.9834338966652199, -0.9780779841387713, -0.9231642935011122, -0.7096245327702275, -0.7720908593071831, -0.7738653192873355, -0.7745985517148618, -0.7751109369066026, -0.7753606180261683, -0.7755428978248878, -0.7757104167231808, -0.775838129820647, -0.7759302232530382, -0.7760568623012967, -0.7762012454845287, -0.7765258174472385, -0.7769498947991266, -0.7768774883128978, -0.7769119671009205, -0.7770215244999639, -0.7771440470660175, -0.7772044162043819, -0.7769721871835215, -0.7771569962678132, -0.7772257416336624, -0.7768037242182979, -0.777015249605532, -0.7769794986866139, -0.7770744657163267, -0.7771389475221987, -0.7771990489253291, -0.7772586082175926, -0.7773205726058395, -0.7766262298866554, -0.7768731685214573, -0.7770311400802047, -0.777247949247007, -0.7772805670279044, -0.7772218674553765, -0.7773179352371781, -0.7773878748858416, -0.7773432464599609, -0.7773777438976146, -0.7774313614456742, -0.7772827313741049, -0.7773415928593388, -0.7773394871464482, -0.7774933248449255, -0.7774867994520399, -0.7771942943996853, -0.7773369386461046, -0.7774366887410482, -0.7773036684106898, -0.7770817782084147, -0.7772240289758753, -0.7773746737727413, -0.7774041531880697]

mnist_gce_005_t = [0.05832305310914915, 0.04595495982716477, 0.05952310477693873, 0.06187365574555263, 0.061676902088026196, 0.06343671946061981, 0.06390519711706372, 0.06415152881501449, 0.060267795601652706, 0.06088411740751728, 0.060698322136369, 0.06491318245521849, 0.06653419710902703, 0.06583170606444279, 0.0658644211768276, 0.06408038247583639, 0.06326357510975664, 0.06585130501745474, 0.06772805377220112, 0.06798590221131841, 0.06750485718043311, 0.06521212782503828, 0.06619272236401834, 0.06714784353350597, 0.06594365629677969, 0.06650444265661967, 0.06701967848050924, 0.0695251740949849, 0.07002415566808645, 0.06776088258458507, 0.06972585175807276, 0.0704794059652421, 0.07047389161876505, 0.07103697640407415, 0.07171014346803227, 0.07004002009621924, 0.07258307688145173, 0.07140596317748227, 0.07051428000546163, 0.12515631400669608, 0.12901730006767637, 0.12961259437931902, 0.1303554494885934, 0.13028786118866664, 0.13233299396725157, 0.13049641003211335, 0.13255851770440732, 0.1328262226676775, 0.13037359979831503, 0.13248682341848805, 0.1295429494687252, 0.1306662903912365, 0.12928858204848231, 0.13085913970238627, 0.13342095270752902, 0.14094929302318224, 0.15676530326406157, 0.20293368304976153, 0.20775834447807728, 0.21332504976126881]
mnist_gce_03_t = [0.12677960098617605, 0.2614678640384226, 0.28771485355682663, 0.29523695239331565, 0.2976018456043675, 0.2989081740146502, 0.29923027355689547, 0.2995816052192821, 0.29823456320445973, 0.2983104648534208, 0.29818959541153156, 0.29972652345895756, 0.3002002276014536, 0.3003283471800386, 0.3000032849609851, 0.29954185714013865, 0.29932163832709185, 0.3000560258515178, 0.3005908164195715, 0.3010153465671464, 0.3004942927509545, 0.29934302465990176, 0.3000002100830897, 0.3002895178971811, 0.2997208519373088, 0.30022960894275447, 0.3002727406565099, 0.30117000523023296, 0.30139972588513037, 0.30057768360711623, 0.30128615717403584, 0.3017641755286603, 0.3015902788611128, 0.30185575019568195, 0.30195955315139134, 0.30149632741231464, 0.3024313120404257, 0.30187809108756475, 0.3016621923539787, 0.30130938922520717, 0.30096010819543145, 0.30052535620052356, 0.29998339267913243, 0.2993060132022946, 0.29845709609799076, 0.2973891492001711, 0.2960396630689501, 0.2943247343413531, 0.29212935203686347, 0.2892927272245287, 0.28558339453302317, 0.2806562294252216, 0.2739745536819099, 0.26465576426126053, 0.2511431040707975, 0.23041714522987605, 0.1957867376506328, 0.13064462464509735, 0.09730216549502482, 0.7409114038820068]
mnist_ce_005_t = [0.1019707243310081, 0.024296627342700987, 0.02189895090543561, 0.021285497314400128, 0.021010090172704714, 0.023057289316008464, 0.019417682658467012, 0.022126328344974227, 0.021385442192355796, 0.020681237023737677, 0.02168506331327888, 0.021090997469921883, 0.022985212500724515, 0.02142905027088189, 0.022109474328656967, 0.0235386723321345, 0.020236018523573852, 0.02304019031839236, 0.024383002697593602, 0.02244203583647805, 0.0253914469770259, 0.024482165579166652, 0.025102320586641608, 0.02496550158494046, 0.023555818700955942, 0.024190587502800738, 0.023473649786578253, 0.024820449252923298, 0.024663698106176295, 0.02504435179548129, 0.024871891049875132, 0.023991656680073963, 0.025767227117386098, 0.02355145267314377, 0.026115375041133797, 0.0244229545527034, 0.02823315694100324, 0.02765231165414051, 0.027351491082873585, 0.028291906644072762, 0.02728112512578563, 0.02528677195103629, 0.027336397013730435, 0.02742673839131987, 0.028170883382360103, 0.027808904072476708, 0.026527868008447975, 0.02684339423974353, 0.025627116763757295, 0.02580991430415045, 0.029945624853587767, 0.026974091062115263, 0.02860236351688698, 0.029385463640921605, 0.028042893223464444, 0.02656460535195134, 0.028623166792094663, 0.02794080665128094, 0.026296878390841983, 0.028701872641427612]
mnist_gce_adam_005_t = [0.09354301102045512, 0.26370318943427673, 0.4896521098166704, 0.5948485739715397, 0.608417738340795, 0.6145590374432504, 0.6196002806723118, 0.6250534892268479, 0.6315183759853243, 0.6395207038480375, 0.64973542192123, 0.6632424157733718, 0.6850212613596685, 0.6998135603943632, 0.7212027022449505, 0.7435778167367808, 0.7816127834241423, 0.8102929234690965, 0.8518833378950756, 0.9062533108207088, 0.9244003400827449, 0.9477645226443808, 0.984940393316663, 1.0321081788610253, 1.063158179867185, 1.0747010385917708, 1.0811763416344509, 1.0893250002505053, 1.0921050759270376, 1.093135413984872, 1.0972728634491151, 1.1055828144225397, 1.111439509355567, 1.120582959065214, 1.1273841845430437, 1.1338726381253867, 1.1427816528454424, 1.147091484838683, 1.1576428737118842, 1.16294505553734, 1.1678772224061607, 1.176211678432301, 1.1800899186264726, 1.1840796127542856, 1.188525439342484, 1.1912553208450685, 1.203626553220157, 1.202773820091453, 1.2032392610599185, 1.2046056109428822, 1.210567222841912, 1.2080135655216875, 1.2132545042731284, 1.2204452459095048, 1.2224473839630892, 1.2228754751943054, 1.2219998284160265, 1.2231769264127235, 1.226865273263409, 1.2318988428720172]
cifar10_gce_005_t = [0.6243067875504492, 0.6061044741421937, 0.5837328620254992, 0.5594483297318219, 0.5340517427772283, 0.508195447549224, 0.48221630342304717, 0.4566669300198556, 0.43152445778250703, 0.40711065530776996, 0.38353415466845053, 0.3607943698763849, 0.3391133621335031, 0.31820366121828575, 0.2984829545021059, 0.27960921898484237, 0.26168482657521974, 0.2445725642144681, 0.22824449948966513, 0.21256983261555434, 0.19795836824923757, 0.1840467227622867, 0.1709701452404261, 0.1584769615903497, 0.14647182952612642, 0.13506850525736813, 0.1245121264830232, 0.11426443103700881, 0.10464488677680497, 0.09539411757141353, 0.09439330752938987, 0.09335806854069234, 0.09231505356729032, 0.09126509781926871, 0.09021732881665231, 0.08917202670127154, 0.0881215088069439, 0.08707454204559327, 0.08603556454181673, 0.08497824277728797, 0.08393210321664811, 0.0828976757824421, 0.08186743948608638, 0.08084927685558797, 0.07983026336878539, 0.0788243241608143, 0.07782819774001838, 0.07684256751090289, 0.07586356260296373, 0.07489311628457575, 0.07393342432048587, 0.07298059229221611, 0.07204067361023693, 0.07109454542812375, 0.07016451039248045, 0.06924527526729639, 0.0683340851714214, 0.0674376460288962, 0.06655064695825182, 0.06566787273933491, 0.06558018219967685, 0.06549163782348237, 0.06540364572157464, 0.06531573017438255, 0.06522777763919699, 0.06514127461446657, 0.06505467297716275, 0.06496795157177582, 0.06488151589615479, 0.0647955663709177, 0.06470938531888856, 0.0646233011244072, 0.06453782415224447, 0.06445138661397828, 0.06436520202292337, 0.06427967364175453, 0.06419337989969387, 0.06410737840665712, 0.06402105281336441, 0.06393520368470088]
cifar10_gce_03_t = [0.6244693093001841, 0.6064173042774199, 0.58480237275362, 0.5611530534923076, 0.5357892654836178, 0.5095299180597068, 0.48283591903746137, 0.45607740059494983, 0.42938369885087024, 0.4028694041073324, 0.3771270528435709, 0.3518348749727013, 0.3272460862994196, 0.3033763702958824, 0.2803416784852744, 0.25806721951812517, 0.2367258859798313, 0.21622821744531392, 0.19653543960303071, 0.17748407255858187, 0.15955658685415988, 0.14236773233860736, 0.12593097500503067, 0.11017172783613209, 0.09516116902232172, 0.08112189093397724, 0.06841021399945023, 0.056909843687382035, 0.048397886194288746, 0.04337670100645888, 0.042905589884354015, 0.04242668649388685, 0.04194640743235749, 0.04146998191873234, 0.04098742103825014, 0.04051203804711502, 0.04010321038878627, 0.03975420720461343, 0.03942623719573021, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793, 0.03941807061433793]
cifar10_ce_005_t = [0.6244835294783113, 0.606290591135621, 0.5843980129808186, 0.5604531455785036, 0.5351987712085247, 0.5095844216644765, 0.48419093638658534, 0.45945441052317626, 0.4351384188979865, 0.4115626983344557, 0.388816609606147, 0.36706697046756764, 0.3461685013026001, 0.32637285850942155, 0.307429824024439, 0.28936220109462746, 0.27235213238745937, 0.25619419924914844, 0.24085155762732038, 0.2262405201792717, 0.21262971460819244, 0.1996445028111339, 0.18743144739419226, 0.17585330903530125, 0.16476093661040073, 0.15434101484715942, 0.14462788309901958, 0.13514055609703068, 0.1262970577925444, 0.11776839103549723, 0.11683196723461156, 0.11585949603468185, 0.11487805284559731, 0.1138891495764256, 0.11289575081318622, 0.11190221458673481, 0.11091579478234057, 0.10992533750832086, 0.10894237719476227, 0.10795224048197274, 0.10696085542440419, 0.10598084703087811, 0.10498873535543682, 0.10400360971689224, 0.10302096121013164, 0.10203958526253701, 0.10106430407613516, 0.10009087342768908, 0.09910753890872002, 0.09812760334461929, 0.09715890176594258, 0.09619417358189822, 0.09523010645061733, 0.09426055029034616, 0.09327966757118702, 0.09231529906392098, 0.09135557506233455, 0.0903911289614108, 0.08943095829751757, 0.08849003900256422, 0.08839477215376165, 0.0882983133983281, 0.0882030785870221, 0.08810755692836311, 0.08801181659516363, 0.08791482363310127, 0.0878183635738161, 0.08772164795961647, 0.08762486622151403, 0.08752782706585197, 0.0874313107546833, 0.08733478494402437, 0.08723782290187149, 0.08714148819860487, 0.087045793313947, 0.0869493565377262, 0.08685262192454604, 0.08675609499630002, 0.08665815767314701, 0.08656105835404662]
cifar10_gce_adam_005_t = [0.6326465472579, 0.6225887667387723, 0.6092452064156532, 0.5946420859545468, 0.5769999932497739, 0.5575483422726392, 0.5372176703065634, 0.5145021196454764, 0.4914324115961791, 0.46830432564020164, 0.4452799156308175, 0.4225897241383792, 0.400119721889496, 0.37849153392016904, 0.3570675618946554, 0.3367051754146816, 0.3168088687583806, 0.29775502011179944, 0.27950887922197587, 0.2619838437065483, 0.24549313988536606, 0.22952601257711658, 0.21451367232948543, 0.2001814149320126, 0.18648964706808333, 0.17346940953284506, 0.16104306299239401, 0.14925747532397513, 0.13813251014798883, 0.12730457577854398, 0.12614235635846857, 0.12494668513536458, 0.1237412473186851, 0.12252891827374701, 0.1212998285889626, 0.1200825417414308, 0.11886701192706828, 0.1176421651616693, 0.11643746010959152, 0.11521415337920193, 0.11400239747017626, 0.11279359403997664, 0.11159303225576882, 0.1104054439812899, 0.10921645183116202, 0.10804788228124385, 0.10688762944191699, 0.10574227590113883, 0.10459900274872784, 0.10346553009003401, 0.10233337339013815, 0.10121713392436504, 0.10011268220841885, 0.09900516737252475, 0.09791983645409347, 0.09684244804084302, 0.09576615747064353, 0.09469317086040975, 0.09362932331860066, 0.09258116632699967, 0.09247615300118925, 0.09237160421907903, 0.09226721897721292, 0.09216323103755714, 0.09205946940928698, 0.09195485617965461, 0.09185025319457055, 0.09174590297043325, 0.09164239652454854, 0.09153879377990962, 0.09143563229590655, 0.09133184421807529, 0.09122894871979953, 0.09112519081681968, 0.09102174360305072, 0.09091892000287773, 0.09081509169191124, 0.09071213062852622, 0.09060899931937458, 0.09050609637051822]
fashion_gce_005_t = [0.14428006167627047, 0.0446272871125903, 0.06181530200358892, 0.0628412886460622, 0.062316263496047894, 0.06339196177406442, 0.06384873270574541, 0.06452788335995539, 0.06021726854352486, 0.06064125278757676, 0.06001147089939977, 0.06393156222171252, 0.06603710070459377, 0.0651983799992336, 0.06448162946022218, 0.06294166301066675, 0.06253606141234437, 0.0644694779647721, 0.06661870010404122, 0.06685337905047667, 0.06540476753686864, 0.0629441673805316, 0.06429141214738289, 0.06499537038306394, 0.06450847366617783, 0.06506655099491276, 0.06540088190800611, 0.06758523319123519, 0.06799828869394128, 0.06575041501472392, 0.06836585742111007, 0.06872234094474049, 0.0681673936980466, 0.0686610693256888, 0.06941069508592287, 0.06790266570738619, 0.07039942475656667, 0.0694204312107629, 0.0684589982467393, 0.06851261094833412, 0.06893025582242342, 0.0685118360734648, 0.06828524937439294, 0.06784900783664648, 0.0695837825971345, 0.06751698705471224, 0.07042509160521956, 0.07113041070393387, 0.06768960596786602, 0.07093470872483318, 0.06922890155679648, 0.07035037431038085, 0.06916894674922028, 0.06919304771555793, 0.06953253953821129, 0.07082274195841616, 0.0696292707054979, 0.06741088586548963, 0.0688045080254475, 0.0687239306482176]
fashion_gce_adam_005_t = [0.0815263283501069, 0.208431178269287, 0.47865794360223746, 0.5436806029619442, 0.5107292315612237, 0.5521363902671469, 0.5614847284141513, 0.5655273931846022, 0.5712617981847788, 0.5758672383427619, 0.5821319248196151, 0.5899127172761492, 0.6007599733438755, 0.6136962076607676, 0.6313087463627258, 0.6561265683049956, 0.6939956452656122, 0.7595399110101991, 0.8359757258577479, 0.8858290347436236, 0.9009531943934661, 0.8894710833020509, 0.8970803656108263, 0.9123506614607242, 0.9440367912687361, 0.9930928177365826, 1.007046131634464, 1.0175668732951293, 1.0352140781578298, 1.043780606559271, 1.0515865717015955, 1.0588961770690772, 1.0646398627685592, 1.0687973105136515, 1.0729209025323185, 1.0658865790974557, 1.0665195915956673, 1.0669677111749643, 1.068213200472399, 1.06931125637713, 1.0730442942027003, 1.0748191493703054, 1.0787571573128099, 1.079796345248922, 1.0844343420138791, 1.0889542821991363, 1.0880591167478513, 1.0846799385433812, 1.0858415861634747, 1.081364489177035, 1.0822271635776595, 1.08730168869305, 1.0848826502791298, 1.083417337515081, 1.0921071155979818, 1.0929739359031536, 1.0984559762053607, 1.09768749783333, 1.0993816975876691, 1.0979224075759866]

mnist_outlier_noise_test = [0.9071, 0.9646, 0.9691, 0.9785, 0.9804, 0.9824, 0.9832, 0.9847, 0.9857, 0.9847, 0.9857, 0.9845, 0.9835, 0.9862, 0.9866, 0.9855, 0.9838, 0.9858, 0.9865, 0.9819, 0.983, 0.9856, 0.9862, 0.9864, 0.9865, 0.9843, 0.9868, 0.9854, 0.9866, 0.9865, 0.9849, 0.9877, 0.9832, 0.9864, 0.9862, 0.9857, 0.9864, 0.9876, 0.9839, 0.9839, 0.9839, 0.9839, 0.9839, 0.9839, 0.9839, 0.9839, 0.9839, 0.9839, 0.9839, 0.9839, 0.9839, 0.9839, 0.9839, 0.9839, 0.9839, 0.9839, 0.9839, 0.9839, 0.9839, 0.9839]



# f, ((ax1, ax4), (ax2, ax5), (ax3, ax6)) = plt.subplots(3, 2, sharex='none', sharey='none')
f, ((ax1, ax4, ax7), (ax2, ax5, ax8), (ax3, ax6, ax9)) = plt.subplots(3, 3, sharex='none', sharey='none')

ax1.plot(mnist_gce_005_test, label="GCE | SGD")
ax1.plot(mnist_gce_adam_005_test, label="GCE | Adam")
ax1.set_ylabel('Testing Accuracy')
ax1.set_xlabel('Epoch')
ax1.set_title('MNIST')
ax1.set_ylim([0, 1])
ax1.legend()
# ax1.legend(bbox_to_anchor=(2.45, 1.5))

ax2.plot(mnist_gce_005_train, label="GCE | SGD")
ax2.plot(mnist_gce_adam_005_train, label="GCE | Adam")
ax2.set_ylabel('Training Loss')
ax2.set_xlabel('Epoch')
# ax2.set_ylim([0, 1])

ax3.plot(mnist_gce_005_t, label="GCE | SGD")
ax3.plot(mnist_gce_adam_005_t, label="GCE | Adam")
ax3.set_ylabel('T Estimation Error')
ax3.set_xlabel('Epoch')
ax3.set_ylim([0, 1])

ax4.plot(cifar10_gce_005_test, label="GCE | SGD")
ax4.plot(cifar10_gce_adam_005_test, label="GCE | Adam")
ax4.set_ylabel('Testing Accuracy')
ax4.set_xlabel('Epoch')
ax4.set_title('CIFAR10')
ax4.set_ylim([0, 1])

ax5.plot(cifar10_gce_005_train, label="GCE | SGD")
ax5.plot(cifar10_gce_adam_005_train, label="GCE | Adam")
ax5.set_ylabel('Training Loss')
ax5.set_xlabel('Epoch')
# ax5.set_ylim([0, 1])

ax6.plot(cifar10_gce_005_t, label="GCE | SGD")
ax6.plot(cifar10_gce_adam_005_t, label="GCE | Adam")
ax6.set_ylabel('T Estimation Error')
ax6.set_xlabel('Epoch')
ax6.set_ylim([0, 1])

ax7.plot(fashion_gce_005_test, label="GCE | SGD")
ax7.plot(fashion_gce_adam_005_test, label="GCE | Adam")
ax7.set_ylabel('Testing Accuracy')
ax7.set_xlabel('Epoch')
ax7.set_title('FASHIONMNIST')
ax7.set_ylim([0, 1])

ax8.plot(fashion_gce_005_train, label="GCE | SGD")
ax8.plot(fashion_gce_adam_005_train, label="GCE | Adam")
ax8.set_ylabel('Training Loss')
ax8.set_xlabel('Epoch')
# ax2.set_ylim([0, 1])

ax9.plot(fashion_gce_005_t, label="GCE | SGD")
ax9.plot(fashion_gce_adam_005_t, label="GCE | Adam")
ax9.set_ylabel('T Estimation Error')
ax9.set_xlabel('Epoch')
ax9.set_ylim([0, 1])

plt.tight_layout()
plt.show()












